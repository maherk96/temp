```sql
-- 1️⃣ Add APP_ID column to TAG
ALTER TABLE QAPORTAL.TAG ADD (APP_ID NUMBER(19,0));

-- 2️⃣ Add foreign key reference to APPLICATION
ALTER TABLE QAPORTAL.TAG
ADD CONSTRAINT FK_TAG_APP FOREIGN KEY (APP_ID)
REFERENCES QAPORTAL.APPLICATION(ID);

-- 3️⃣ Populate APP_ID based on TEST_TAG → TEST_LAUNCH linkage
MERGE INTO QAPORTAL.TAG t
USING (
    SELECT tt.TAG_ID, MAX(tl.APP_ID) KEEP (DENSE_RANK FIRST ORDER BY tl.CREATED DESC) AS APP_ID
    FROM QAPORTAL.TEST_TAG tt
    JOIN QAPORTAL.TEST_LAUNCH tl ON tt.TEST_LAUNCH_ID = tl.ID
    WHERE tt.TAG_ID IS NOT NULL AND tl.APP_ID IS NOT NULL
    GROUP BY tt.TAG_ID
) src
ON (t.ID = src.TAG_ID)
WHEN MATCHED THEN
UPDATE SET t.APP_ID = src.APP_ID;

-- 4️⃣ Add uniqueness constraint so each app’s tag names are unique
ALTER TABLE QAPORTAL.TAG
ADD CONSTRAINT UK_TAG_APP UNIQUE (APP_ID, NAME);
```
